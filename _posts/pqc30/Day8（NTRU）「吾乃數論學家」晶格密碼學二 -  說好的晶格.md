
ä»Šå¤©æˆ‘å€‘ä¾†è§£é‡‹æ˜¨å¤©ä»‹ç´¹çš„ã€Œå¾ä¹ƒæ•¸è«–å­¸å®¶ã€ç‚ºä½•æ˜¯æ™¶æ ¼å¯†ç¢¼å­¸ï¼Ÿ
èˆ‡ä¹‹å‰çš„äºŒç¶­æ™¶æ ¼ç›¸ä¼¼ï¼Œé—œéµéƒ½åœ¨è§£ç¢¼çš„æ­£ç¢ºæ€§

# å›é¡§è§£ç¢¼æ­£ç¢ºæ€§çš„è­‰æ˜

ä¹‹æ‰€ä»¥è§£ç¢¼æœƒæˆåŠŸï¼Œä¸»è¦åŸå› æ˜¯å› ç‚º
$$
a(x) = p g(x) \cdot r(x)+f(x)\cdot m(x)
$$
ä¹‹å³æ‰‹é‚Šéƒ¨åˆ†çš„ä¿‚æ•¸å¯ä»¥è¢«æ§åˆ¶ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥é‚„åŸå‡ºæ•´æ•¸ä¸Šçš„ç­‰è™Ÿï¼ˆéæ¨¡é™¤ä¸Šçš„ç­‰è™Ÿï¼‰ï¼Œç„¶å¾Œå†åšå¾ŒçºŒçš„æœ‰è™Ÿæå‡èˆ‡æ¨¡é™¤ p é‹ç®—ã€‚

æ„æ€æ˜¯ï¼Œå¦‚æœæˆ‘å€‘æƒ³è¦å½é€ ä¸€å€‹å‡çš„å¯†é‘° (f(x), g(x)) ï¼Œé‚£ä»–åªè¦æ»¿è¶³

ä¸€ã€
$$
f(x) h(x) = g(x) \text{ in } R_{q} = \mathbb{Z}_{q}[x] / \langle x^N-1\rangle 
$$
å…¶ä¸­ h(x) èˆ‡ q æ˜¯å…¬é‘°çš„å…§å®¹ã€‚

äºŒã€f(x) èˆ‡ g(x) çš„ä¿‚æ•¸éƒ½ä¸å¤§ï¼Œä»¥è‡³æ–¼ä»¥ä¸‹å¤šé …å¼çš„ä¿‚æ•¸çµ•å°å€¼ä¸è¶…é q/2ã€‚
$$
p g(x) \cdot r(x)+f(x)\cdot m(x)
$$

é€™å€‹æ­¥é©Ÿæ˜¯ä¸æ˜¯èˆ‡ä¹‹å‰çœ‹åˆ°çš„äºŒç¶­æ™¶æ ¼éå¸¸é›·åŒï¼ŸğŸ˜€

# å°‡å¤šé …å¼ä¹˜æ³•å¯«ç‚ºçŸ©é™£ä¹˜æ³•

ç‚ºäº†è¦ç”¨å‘é‡ç©ºé–“è¨è«–ï¼Œæˆ‘å€‘æ‡‰è©²ä»‹ç´¹ä¸€å€‹ç”¨çŸ©é™£ä¹˜æ³•ä¾†å¯«çš„å¤šé …å¼ä¹˜æ³•ï¼š

è€ƒæ…®åœ¨ R åº•ä¸‹çš„é‹ç®—
$$
g(x) = f(x) h(x) \text{ in }R = \mathbb{Z}[x] / \langle x^N-1 \rangle.
$$
ä¸¦å°‡ä¿‚æ•¸å¯«å¥½
$$
g(x) = g_{0} + g_{1}x+g_{2}x^{2}+\cdots+g_{N-1} x^{N-1}
$$
$$
f(x) = f_{0} + f_{1}x+f_{2}x^{2}+\cdots+f_{N-1} x^{N-1}
$$
$$
h(x) = h_{0} + h_{1}x+h_{2}x^{2}+\cdots+h_{N-1} x^{N-1}
$$
ï¼ˆä»¥ä¸‹çš„æ•¸å­¸çœ‹éå³å¯ï¼Œæˆ‘å€‘æœƒç”¨ç¨‹å¼é©—è­‰ï¼‰
é‚£éº¼æ ¹æ“šåœ¨ R åº•ä¸‹çš„æ¨¡é™¤é‹ç®—è¦å‰‡ï¼Œæˆ‘å€‘çŸ¥é“

$$
g_{k} = \sum_{i=0}^{k} f_{i}h_{k-i} + \sum_{i=k+1}^{N-1}  f_{i}h_{N+k-i}
$$
ç‚ºäº†é€²ä¸€æ­¥åˆ†æï¼Œæˆ‘å€‘å°‡å…¶å¯«æˆçŸ©é™£å½¢å¼ï¼š
$$
[g_{0}, g_{1},\dots,g_{N-1}] = [f_{0}, f_{1},\dots,f_{N-1}] 
\begin{bmatrix}
h_{0} & h_{1} & h_{2} &  \cdots & h_{N-1}\\
h_{N-1} & h_{0} & h_{1} & \cdots & h_{N-2} \\  
h_{N-2}  & h_{N-1} & h_{0}  & \cdots  & h_{N-3}\\
\vdots  & \vdots   & \vdots  & \ddots  & \vdots   \\
h_{1} & h_{2} & h_{3} & \cdots & h_{0} 
\end{bmatrix}
$$
ç°¡å¯«ç‚ºï¼š
$$
g = f\cdot H
$$

å¥½ï¼Œè­‰æ˜éƒ¨åˆ†å¾ˆç„¡èŠï¼Œæˆ‘å€‘ç”¨ç¨‹å¼ç°¡å–®é©—è­‰çœ‹çœ‹ï¼š
```
N = 11

# å¤šé …å¼ç’°
R_poly = quotient(PolynomialRing(ZZ,x),x^N-1)

# éš¨æ©Ÿç”Ÿæˆå¤šé …å¼
f = R_poly([randint(-10,10) for i in range(N)])
h = R_poly([randint(-10,10) for i in range(N)])

print("f =", f)
print("h =", h)

g = f*h
print("\ng = f * h =", g)


# Ouptuts:
# f = -6*xbar^10 + xbar^8 + 10*xbar^7 - 5*xbar^6 + xbar^5 + 3*xbar^4 - 6*xbar^3 + 7*xbar^2 + 7*xbar + 9
# h = xbar^10 + 5*xbar^9 - 9*xbar^8 - 7*xbar^7 + 2*xbar^6 - 5*xbar^5 + 7*xbar^4 - 3*xbar^3 + 4*xbar^2 - 7*xbar - 6
# 
# g = f * h = -xbar^10 - 45*xbar^9 - 194*xbar^8 - 101*xbar^7 + 142*xbar^6 - 44*xbar^5 + 3*xbar^4 - 69*xbar^3 + 13*xbar^2 - 239*xbar + 157
```

å‘¼å« Matrix é¡åˆ¥ï¼Œå»ºæ§‹ä¸Šé¢çš„ H çŸ©é™£ï¼Œä¸¦ä½¿ç”¨ä»–å…§å»ºçš„çŸ©é™£ä¹˜æ³•ï¼š
```
f_coeff = f.list()
h_coeff = h.list()
g_coeff = g.list()


H = Matrix([[h_coeff[(i-j)%N] for i in range(N)] for j in range(N)])
print(H)
F = Matrix([[f_coeff[i] for i in range(N)]])

print(F)
print("\n")
print(F*H)
print(g_coeff)

# Outputs:
# [-6 -7  4 -3  7 -5  2 -7 -9  5  1]
# [ 1 -6 -7  4 -3  7 -5  2 -7 -9  5]
# [ 5  1 -6 -7  4 -3  7 -5  2 -7 -9]
# [-9  5  1 -6 -7  4 -3  7 -5  2 -7]
# [-7 -9  5  1 -6 -7  4 -3  7 -5  2]
# [ 2 -7 -9  5  1 -6 -7  4 -3  7 -5]
# [-5  2 -7 -9  5  1 -6 -7  4 -3  7]
# [ 7 -5  2 -7 -9  5  1 -6 -7  4 -3]
# [-3  7 -5  2 -7 -9  5  1 -6 -7  4]
# [ 4 -3  7 -5  2 -7 -9  5  1 -6 -7]
# [-7  4 -3  7 -5  2 -7 -9  5  1 -6]
# [ 9  7  7 -6  3  1 -5 10  1  0 -6]
# 
# [ 157 -239   13  -69    3  -44  142 -101 -194  -45   -1]
# [157, -239, 13, -69, 3, -44, 142, -101, -194, -45, -1]
```
å¯ä»¥ç™¼ç¾ï¼Œå…©å€‹çµæœæ˜¯ä¸€æ¨£çš„ï¼Œæ‰€ä»¥æˆ‘å€‘å·²é©—è­‰é€™å€‹ç­‰å¼çš„æ­£ç¢ºæ€§ã€‚

# å°‡ f(x) èˆ‡ g(x) å¯«æˆçŸ­å‘é‡ï¼š

## å…ˆåšæˆå‘é‡

é¦–å…ˆï¼Œå› ç‚º f(x) èˆ‡ g(x) æ‡‰æ»¿è¶³
$$
f(x) h(x) = g(x) \text{ in } R_{q} = \mathbb{Z}_{q}[x] / \langle x^N-1\rangle 
$$
æ‰€ä»¥æˆ‘å€‘å¯ä»¥æ”¹å¯«ç‚º
$$
f(x) h(x) = g(x) + qu(x) \text{ in } R = \mathbb{Z}[x] / \langle x^N-1\rangle 
$$
u(x) æ˜¯æŸå€‹åœ¨ R è£¡é¢çš„å¤šé …å¼ã€‚

å› æ­¤æˆ‘å€‘å¯ä»¥æ•…æŠ€é‡æ–½ï¼š
$$
\begin{align}
(f(x),g(x))  & =(f(x),0)+(0, g(x)) \\
 & =(f(x),0)+(0, f(x)h(x) - qu(x)) \\
 & =(f(x),0)+(0, f(x)h(x))+( 0, - qu(x)) \\
 & =f(x) (1, h(x))  -u(x) (0,q)
\end{align}
$$
ç¾åœ¨æˆ‘å€‘å˜—è©¦å°‡é€™å€‹å¯«æˆã€Œä¿‚æ•¸çš„å‘é‡ã€ï¼šé¦–å…ˆå°ä»˜ f(x)(1, h(x))
$$
f(x)(1,h(x)) = (f(x),f(x)h(x))
$$
è€Œå·¦é‚Šå¯ä»¥å¯«ç‚ºä»¥ä¸‹çŸ©é™£ä¹˜æ³•
$$
[f_{0}, f_{1},\dots,f_{N-1}] 
\begin{bmatrix} 
1 & 0 & 0 &\cdots & 0& h_{0} & h_{1} & h_{2} &  \cdots & h_{N-1}\\
0 & 1 & 0 &\cdots & 0& h_{N-1} & h_{0} & h_{1} & \cdots & h_{N-2} \\  
0 & 0 & 1 &\cdots & 0& h_{N-2}  & h_{N-1} & h_{0}  & \cdots  & h_{N-3}\\
0 & 0 & 0 &\cdots & 0& \vdots  & \vdots   & \vdots  & \ddots  & \vdots   \\
0 & 0 & 0 &\cdots & 1& h_{1} & h_{2} & h_{3} & \cdots & h_{0} 
\end{bmatrix}
$$
æˆ‘å€‘æŠŠå®ƒè¨˜ä½œ
$$
f \cdot \begin{bmatrix}
I & H
\end{bmatrix}
$$

æ¥è‘—å°ä»˜ -u(x)(0, q)
$$
[-u_{0}, -u_{1},\dots-u_{N-1}] 
\begin{bmatrix} 
0 & 0 & 0 &\cdots & 0 & 
q & 0 & 0 &\cdots & 0\\
0 & 0 & 0 &\cdots & 0   & 
0 & q & 0 &\cdots & 0\\  
0 & 0 & 0 &\cdots & 0 & 
0 & 0 & q &\cdots & 0\\
0 & 0 & 0 &\cdots & 0    & 
0 & 0 & 0 &\cdots & 0   \\
0 & 0 & 0 &\cdots & 0 & 
0 & 0 & 0 &\cdots & q
\end{bmatrix}
$$
æˆ‘å€‘æŠŠå®ƒè¨˜ä½œ
$$
-u\begin{bmatrix}
O  & q
\end{bmatrix}
$$

å› æ­¤ï¼Œ
$$
(f(x),g(x)) = f(x)(1,h(x)) -u(x) (0,q)
$$
å¯ä»¥å¯«ç‚º
$$
[f_{0},f_{1},\dots,f_{N-1},g_{0},g_{1},\dots,g_{N-1}]
=f \cdot \begin{bmatrix}
I & H
\end{bmatrix} - u \begin{bmatrix}
O &  q
\end{bmatrix}
$$
æˆ–æ•´æ›´ç°¡æ½”åœ°
$$
(f,g) = (f,-u)\begin{bmatrix}
I & H \\
O & q
\end{bmatrix}
$$
## çŸ­å‘é‡å•é¡Œ

å¥½çš„ï¼Œæ¥è‘—æˆ‘å€‘ä¾†åˆ†æé€™å€‹çŸ©é™£æ–¹ç¨‹å¼
$$
(f,g) = (f,-u)\begin{bmatrix}
I & H \\
O & q
\end{bmatrix}
$$
å·¦æ‰‹é‚Šæ˜¯ä¸€å€‹ 2N ç¶­åº¦çš„å‘é‡ï¼Œæˆ‘å€‘å¸Œæœ›ä»–è¶Šå°è¶Šå¥½ã€‚

å³æ‰‹é‚Šå¯ä»¥çœ‹æˆæ˜¯çŸ©é™£
$$
\begin{bmatrix}
I & H \\
O & q
\end{bmatrix}
$$
å…¶è¡Œå‘é‡çš„æ•´ä¿‚æ•¸ (f_0, ..., f_N-1, -u_0, ..., -u_N-1) ç·šæ€§çµ„åˆ

å¼•æ­¤æˆ‘å€‘åœ¨åšçš„å…¶å¯¦æ˜¯æ±ºå®šå¥½æ•´ä¿‚æ•¸
$$
[f_{0},f_{1},\dots,f_{N-1}, -u_{0},-u_{1},\dots,-u_{N-1}]
$$
å¥½è®“ä»–çš„çµæœå‘é‡
$$
[f_{0},f_{1},\dots,f_{N-1},g_{0},g_{1},\dots,g_{N-1}]
$$
å„˜é‡çš„å°ã€‚

æ­å–œï¼Œé€™å°±æ˜¯æ¨™æº–çš„æ™¶æ ¼çŸ­å‘é‡å•é¡Œã€‚



æ˜å¤©æ˜¯ç¬¬ä¹å¤©ï¼Œæ˜¯æ™¶æ ¼å¯†ç¢¼å­¸çš„æœ€å¾Œä¸€ç¯‡ï¼Œæˆ‘å€‘æœƒå¸¶éç›¸é—œçš„æ”»æ“Šæ–¹å¼ï¼Œä¸¦ä»‹ç´¹ä¸€äº›å…¶ä»–çš„åŠ å¯†æ¨™æº–ã€‚

# Takeaway
- å¤šé …å¼ä¹˜æ³•å¯ä»¥ç”¨çŸ©é™£ä¾†å¯«ï¼Œé™¤äº†å¯ä»¥ç”¨ä»£æ•¸è­‰æ˜ä»¥å¤–ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥å¯«ç¨‹å¼ä¾†ç¢ºèªè©²ç­‰å¼ã€‚
- NTRU å¯†ç¢¼ç³»çµ±çš„è§£ç¢¼æ­£ç¢ºæ€§ä¾è³´æ–¼åƒèˆ‡å…¶ä¸­çš„å¤šé …å¼çš„ä¿‚æ•¸å¤ å°
- æ‰¿ä¸Šï¼Œä¹Ÿå› æ­¤æˆ‘å€‘å¯ä»¥æŠŠå°‹æ‰¾ f(x) èˆ‡ g(x) çš„éç¨‹çœ‹ç‚ºã€Œå°‹æ‰¾çŸ­å‘é‡ã€



